module inductive where
option irrelevance true

def Path (A : U) (x y : A) : U := PathP (<_> A) x y
def idp (A : U) (x : A) : Path A x x := <_> x
def + (A B: U) : U := Î£ (x : ğŸ), indâ‚‚ (Î» (_ : ğŸ), U) A B x

def 0-ind (C: ğŸ â†’ U) (z: ğŸ) : C z := ind-empty (C z) z

def 1-rec (C: U) (x: C) : ğŸ â†’ C := indâ‚ (\(_:ğŸ), C) x
def 1-ind (C: ğŸ â†’ U) (x: C â˜…) : ĞŸ (z: ğŸ), C z := indâ‚ C x
--def 1-Î² (C: U) (c: C): Path C (1-rec C c â˜…) c := idp C c
--def 1-Î· (z: ğŸ) : Path ğŸ â˜… z := idp ğŸ â˜…

def 2-ind (C: ğŸ â†’ U) (x: C 0â‚‚) (y: C 1â‚‚) : ĞŸ (z: ğŸ), C z := indâ‚‚ C x y
def 2-rec (C: U) (x y: C) : ĞŸ (z: bool), C := indâ‚‚ (\(_:ğŸ), C) x y

def 2-Î²â‚ (C : ğŸ â†’ U) (f : Î  (x : ğŸ), C 0â‚‚) (g : Î  (y : ğŸ), C 1â‚‚) : PathP (<_>C 0â‚‚) (f 0â‚‚) (indâ‚‚ (Î» (x : ğŸ), C x) (f 0â‚‚) (g 1â‚‚) 0â‚‚) := <_> f 0â‚‚
--def 2-Î²â‚‚ (C : ğŸ â†’ U) (f : Î  (x : ğŸ), C 0â‚‚) (g : Î  (y : ğŸ), C 1â‚‚) : PathP (<_>C 1â‚‚) (g 1â‚‚) (indâ‚‚ (Î» (x : ğŸ), C x) (f 0â‚‚) (g 1â‚‚) 1â‚‚) := <_> g 1â‚‚

--def 2-Î· (c : ğŸ) : + (PathP (<_> ğŸ) c 0â‚‚) (PathP (<_> ğŸ) c 1â‚‚) := indâ‚‚ (Î» (c : ğŸ), + (PathP (<_> ğŸ) c 0â‚‚) (PathP (<_> ğŸ) c 1â‚‚)) (0â‚‚, <_> 0â‚‚) (1â‚‚, <_> 1â‚‚) c

def Wâ€² (A : U) (B : A â†’ U) : U := W (x: A), B x
def supâ€² (A : U) (B : A â†’ U) (x : A) (f : B x â†’ Wâ€² A B) : Wâ€² A B := sup A B x f

def W-ind (A : U) (B : A â†’ U) (C : (W (x : A), B x) â†’ U)
    (g : Î  (x : A) (f : B x â†’ (W (x : A), B x)), (Î  (b : B x), C (f b)) â†’ C (sup A B x f))
    (w : W (x : A), B x)
  : C w := indáµ‚ A B C g w

def W-rec (A : U) (B : A â†’ U) (C : U)
    (g : Î  (x : A) (f : B x â†’ (W (x : A), B x)), (B x â†’ C) â†’ C)
    (w : W (x : A), B x)
  : C := indáµ‚ A B (Î» (_ : W (x : A), B x), C) g w

def W-indâ€² (A : U) (B : A â†’ U) (C : (W (x : A), B x) â†’ U)
    (Ï† : Î  (x : A) (f : B x â†’ (W (x : A), B x)), C (sup A B x f))
  : Î  (w : W (x : A), B x), C w
 := indáµ‚ A B C (Î» (x : A) (f : B x â†’ (W (x : A), B x)) (g : Î  (b : B x), C (f b)), Ï† x f)

def W-case (A : U) (B : A â†’ U) (C : U) (g : Î  (x : A) (f : B x â†’ (W (x : A), B x)), C)
  : (W (x : A), B x) â†’ C
 := W-indâ€² A B (Î» (_ : W (x : A), B x), C) g

-- def indáµ‚-Î² (A : U) (B : A â†’ U) (C : (W (x : A), B x) â†’ U)
--     (g : Î  (x : A) (f : B x â†’ (W (x : A), B x)), (Î  (b : B x), C (f b)) â†’ C (sup A B x f))
--     (a : A) (f : B a â†’ (W (x : A), B x))
--  : PathP (<_> C (sup A B a f)) (indáµ‚ A B C g (sup A B a f)) (g a f (Î» (b : B a), indáµ‚ A B C g (f b)))
-- := <_> g a f (Î» (b : B a), indáµ‚ A B C g (f b))

def W-projâ‚ (A : U) (B : A â†’ U) : (W (x : A), B x) â†’ A
 := W-case A B A (Î» (x : A) (f : B x â†’ (W (x : A), B x)), x)

--def W-projâ‚‚ (A : U) (B : A â†’ U) : Î  (w : W (x : A), B x), B (W-projâ‚ A B w) â†’ (W (x : A), B x)
-- := W-indâ€² A B (Î» (w : W (x : A), B x), B (W-projâ‚ A B w) â†’ (W (x : A), B x))
--               (Î» (x : A) (f : B x â†’ (W (x : A), B x)), f)

--def W-Î· (A : U) (B : A â†’ U)
--  : Î  (w : W (x : A), B x), Path (W (x : A), B x) (sup A B (W-projâ‚ A B w) (W-projâ‚‚ A B w)) w
-- := W-indâ€² A B (Î» (w : W (x : A), B x), Path (W (x : A), B x) (sup A B (W-projâ‚ A B w) (W-projâ‚‚ A B w)) w)
--               (Î» (x : A) (f : B x â†’ (W (x : A), B x)), <_> sup A B x f)

--def trans-W (A : I â†’ U) (B : Î  (i : I), A i â†’ U) (a : A 0) (f : B 0 a â†’ (W (x : A 0), B 0 x)) : W (x : A 1), B 1 x
-- := sup (A 1) (B 1) (transp (<i> A i) 0 a) (transp (<i> B i (transFill (A 0) (A 1) (<j> A j) a @ i) â†’ (W (x : A i), B i x)) 0 f)

